!function(t){function e(i){if(r[i])return r[i].exports;var o=r[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i=window.webpackJsonp;window.webpackJsonp=function(r,n){for(var s,a,l=0,c=[];l<r.length;l++)a=r[l],o[a]&&c.push.apply(c,o[a]),o[a]=0;for(s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s]);for(i&&i(r,n);c.length;)c.shift().call(null,e)};var r={},o={0:0};return e.e=function(t,i){if(0===o[t])return i.call(null,e);if(void 0!==o[t])o[t].push(i);else{o[t]=[i];var r=document.getElementsByTagName("head")[0],n=document.createElement("script");n.type="text/javascript",n.charset="utf-8",n.async=!0,n.src=e.p+""+t+"."+({}[t]||t)+".js",r.appendChild(n)}},e.m=t,e.c=r,e.p="/",e(0)}([function(t,e,i){"use strict";i(1);var r=i(14),o=(new r,i(22)),n=!0;history.state||"?join"!==window.location.search||(n=!1);var s=new o({elem:document.getElementById("auth-window"),isLoginFormActive:n}),a=n?"login":"join";history.replaceState({type:a},a,"?"+a),window.onpopstate=function(t){t.state&&("join"===t.state.type?s.setJoin(!0):s.setLogin(!0))},s.on("auth-window_switched",function(t){t.detail.isPopState||(t.detail.isLoginFormActive?history.pushState({type:"login"},"login","?login"):history.pushState({type:"join"},"join","?join"))});var l=function(t){var e=this;this.elem=t.elem,this.wrapper=this.elem.querySelector(".authorization__background-wrapper"),this.leftPic1=this.wrapper.querySelector(".authorization__left-pic:nth-child(1)"),this.leftPic2=this.wrapper.querySelector(".authorization__left-pic:nth-child(2)"),this.rightPic1=this.wrapper.querySelector(".authorization__right-pic:nth-child(1)"),this.rightPic2=this.wrapper.querySelector(".authorization__right-pic:nth-child(2)"),this.currentLeftPic1Index=-1,this.currentLeftPic2Index=-1,this.currentRightPic1Index=-1,this.currentRightPic2Index=-1,this.currentLeftPic=1,this.currentRightPic=1;var i=JSON.parse(this.wrapper.dataset.images);this.images=[];for(var r=function(t){var r=new Image;e.images[t]={index:t,url:i[t],preloadedImg:r,loaded:!1},r.onload=function(i){return e.images[t].loaded=!0,e.currentLeftPic1Index===-1&&1===e.currentLeftPic?void e.setLeftPicImage(1,e.images[t]):e.currentLeftPic2Index===-1&&2===e.currentLeftPic?void e.setLeftPicImage(2,e.images[t]):e.currentRightPic1Index===-1&&1===e.currentRightPic?void e.setRightPicImage(1,e.images[t]):e.currentRightPic2Index===-1&&2===e.currentRightPic?void e.setRightPicImage(2,e.images[t]):void 0},r.src=i[t]},o=0;o<i.length;o++)r(o);this.leftPic2.addEventListener("animationstart",function(t){e.setLeftPicImage(2,e.getNextLeftImage())},!1),this.leftPic1.addEventListener("animationiteration",function(t){e.setLeftPicImage(1,e.getNextLeftImage())},!1),this.leftPic2.addEventListener("animationiteration",function(t){e.setLeftPicImage(2,e.getNextLeftImage())},!1),this.rightPic2.addEventListener("animationstart",function(t){e.setRightPicImage(2,e.getNextRightImage())},!1),this.rightPic1.addEventListener("animationiteration",function(t){e.setRightPicImage(1,e.getNextRightImage())},!1),this.rightPic2.addEventListener("animationiteration",function(t){e.setRightPicImage(2,e.getNextRightImage())},!1)};l.prototype.getNextLeftImage=function(){var t=1===this.currentLeftPic?this.currentLeftPic1Index:this.currentLeftPic2Index,e=1===this.currentRightPic?this.currentRightPic1Index:this.currentRightPic2Index,i=(t+1)%this.images.length;do{if(this.images[i].loaded===!0&&i!==e)return this.images[i];i=(i+1)%this.images.length}while(i!==t);return this.images[e]?this.images[e]:null},l.prototype.getNextRightImage=function(){var t=1===this.currentRightPic?this.currentRightPic1Index:this.currentRightPic2Index,e=1===this.currentLeftPic?this.currentLeftPic1Index:this.currentLeftPic2Index,i=t-1;i<0&&(i=this.images.length-1);do{if(this.images[i].loaded===!0&&i!==e)return this.images[i];i-=1,i===-1&&(i=this.images.length-1)}while(i!==t);return this.images[e]?this.images[e]:null},l.prototype.setLeftPicImage=function(t,e){this.currentLeftPic=t,1===t?e?(this.currentLeftPic1Index=e.index,this.setUrl(this.leftPic1,e.url)):this.setUrl(this.leftPic1,null):2===t&&(e?(this.currentLeftPic2Index=e.index,this.setUrl(this.leftPic2,e.url)):this.setUrl(this.leftPic2,null))},l.prototype.setRightPicImage=function(t,e){this.currentRightPic=t,1===t?e?(this.currentRightPic1Index=e.index,this.setUrl(this.rightPic1,e.url)):this.setUrl(this.rightPic1,null):2===t&&(e?(this.currentRightPic2Index=e.index,this.setUrl(this.rightPic2,e.url)):this.setUrl(this.rightPic2,null))},l.prototype.setUrl=function(t,e){e?t.style.backgroundImage="url('"+e+"')":t.style.backgroundImage="none"};new l({elem:document.getElementById("authorization")})},function(t,e){},,,,,,,,,,,,,function(t,e,i){"use strict";var r=function(t){var e=this;document.addEventListener("error",function(t){var i=t.detail;e.call(i)})};r.prototype.call=function(t){i.e(1,function(e){var r=i(15).ComponentError,o=i(16);if(!(t instanceof r))throw t;if(401===t.status)localStorage.setItem("redirected_url",window.location.href),window.location="/authorization";else{var n=new o({message:t.message});n.activate()}})},t.exports=r},function(t,e){"use strict";function i(t){this.name="CustomError",this.message=t,Error.captureStackTrace?Error.captureStackTrace(this,i):this.stack=Error().stack}function r(t,e){i.call(this,t||"An error has occurred"),this.name="ComponentError",this.status=e}function o(t,e,i){r.call(this,t||"An error has occurred. Check if javascript is enabled",i),this.name="ClientError",this.detail=e}function n(t){o.call(this,t||"Image not found. It probably has been removed",null,404),this.name="ImageNotFound"}function s(t,e){r.call(this,t||"There is some error on the server side",e),this.name="ServerError"}i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,r.prototype=Object.create(i.prototype),r.prototype.constructor=r,o.prototype=Object.create(r.prototype),o.prototype.constructor=o,n.prototype=Object.create(o.prototype),n.prototype.constructor=n,s.prototype=Object.create(r.prototype),s.prototype.constructor=s,t.exports={ComponentError:r,ClientError:o,ImageNotFound:n,ServerError:s}},,,function(t,e){"use strict";t.exports={on:function(t,e){this.elem?this.elem.addEventListener(t,e):this.listeners.push({eventName:t,cb:e})},trigger:function(t,e){this.elem.dispatchEvent(new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:e}))},error:function(t){this.elem.dispatchEvent(new CustomEvent("error",{bubbles:!0,cancelable:!0,detail:t}))}}},,,,function(t,e,i){"use strict";var r=(i(23),i(18)),o=(i(15).ClientError,i(24)),n=function(t){var e=this;this.elem=t.elem,this.isLoginFormActive=t.isLoginFormActive,this.isAvailable=!0,this.headerElem=this.elem.querySelector(".window__header"),this.panel=this.elem.querySelector("div.window__panel"),this.loginFormElem=this.elem.querySelector('form[name="login"]'),this.joinFormElem=this.elem.querySelector('form[name="join"]'),this.setJoinAEHandler=this.setJoinAEHandler.bind(this),this.setLoginAEHandler=this.setLoginAEHandler.bind(this),this.joinForm=new o({elem:this.joinFormElem,fields:{username:{},email:{alias:"e-mail"},password:{},"password-again":{extra:!0,password:"password",alias:"password"}},url:"/join"}),this.loginForm=new o({elem:this.loginFormElem,fields:{username:{validator:"non-empty"},password:{validator:"non-empty"}},url:"/login"}),this.loginForm.on("form_sent",function(t){e.redirect()}),this.joinForm.on("form_sent",function(t){e.redirect()}),this.isLoginFormActive?this.setLoginAEHandler():this.setJoinAEHandler(),this.elem.onclick=function(t){e.isAvailable&&t.target.matches(".window__message .ref")&&e.toggle()},this.elem.addEventListener("focus",function(t){if(t.target.classList&&t.target.classList.contains("textbox__field")){var e=t.target.closest(".textbox");e&&e.classList.add("textbox_focus")}},!0),this.elem.addEventListener("blur",function(t){if(t.target.classList&&t.target.classList.contains("textbox__field")){var e=t.target.closest(".textbox");e&&e.classList.remove("textbox_focus")}},!0)};n.prototype.redirect=function(){var t="/";t=localStorage.getItem("redirected_url")||t,localStorage.removeItem("redirected_url"),window.location=t},n.prototype.setJoin=function(t){this.joinForm.clear(),this.isAvailable=!1,this.loginForm.setAvailable(!1),this.loginFormElem.classList.add("auth-window__form-fading-out"),this.trigger("auth-window_switched",{isLoginFormActive:!1,isPopState:t}),this.loginFormElem.addEventListener("animationend",this.setJoinAEHandler,!1)},n.prototype.setJoinAEHandler=function(){this.headerElem.textContent="signing up",this.isAvailable=!0,this.loginForm.setAvailable(!0),this.loginFormElem.classList.remove("auth-window__form-fading-out"),this.loginFormElem.classList.add("auth-window__form_invisible"),this.joinFormElem.classList.remove("auth-window__form_invisible"),this.joinFormElemHeight=this.joinFormElemHeight||this.joinFormElem.scrollHeight,this.panel.style.height=this.joinFormElemHeight+"px",this.isLoginFormActive=!1,this.loginFormElem.removeEventListener("animationend",this.setJoinAEHandler)},n.prototype.setLogin=function(t){this.loginForm.clear(),this.isAvailable=!1,this.joinForm.setAvailable(!1),this.joinFormElem.classList.add("auth-window__form-fading-out"),this.trigger("auth-window_switched",{isLoginFormActive:!0,isPopState:t}),this.joinFormElem.addEventListener("animationend",this.setLoginAEHandler,!1)},n.prototype.setLoginAEHandler=function(){this.headerElem.textContent="logging in",this.isAvailable=!0,this.joinForm.setAvailable(!0),this.joinFormElem.classList.remove("auth-window__form-fading-out"),this.joinFormElem.classList.add("auth-window__form_invisible"),this.loginFormElem.classList.remove("auth-window__form_invisible"),this.loginFormElemHeight=this.loginFormElemHeight||this.loginFormElem.scrollHeight,this.panel.style.height=this.loginFormElemHeight+"px",this.isLoginFormActive=!0,this.joinFormElem.removeEventListener("animationend",this.setLoginAEHandler)},n.prototype.toggle=function(){this.isLoginFormActive?this.setJoin():this.setLogin()};for(var s in r)n.prototype[s]=r[s];t.exports=n},function(t,e){"use strict";function i(t,e){var i=void 0;for(t=t||s.plain,e=e||"this property";~(i=t.indexOf(n));)t=t.substring(0,i)+e+t.substring(i+n.length);return t}function r(t){if(!Array.isArray(t)){var e=[];for(var r in t)e.push({property:r,value:t[r]});t=e}for(var o=[],n=function(e){var r=t[e].validator;if(r||(r=t[e].property),!c[r])throw Error("no validator for this property: "+r);c[r].checks.forEach(function(n){n.test(t[e].value,t[e],t)||o.push({property:t[e].property,message:i(n.errorMessage,t[e].alias||t[e].property||r)})})},s=0;s<t.length;s++)n(s);return o}function o(t,e){var i=!0;return c[t].checks.forEach(function(t){t.test(e)||(i=!1)}),i}var n="[property]",s={plain:"incorrect [property]",empty:"[property] must not be empty",tooBig:function(t){return t?"[property] must be lower than "+(t+1)+" symbols":"[property] is too big"},tooSmall:function(t){return t?"[property] must be greater than "+(t-1)+" symbols":"[property] is too short"}},a={regExp:function(t,e){return t.test(e)},max:function(t,e){return e.length<=t},min:function(t,e){return e.length>=t},nonEmpty:function(t){return t.length>0}},l={max:function(t,e){return{errorMessage:e||s.tooBig(t),test:a.max.bind(null,t)}},min:function(t,e){return{errorMessage:e||s.tooSmall(t),test:a.min.bind(null,t)}},nonEmpty:function(t){return{errorMessage:t||s.empty,test:a.nonEmpty}}},c={"non-empty":{checks:[l.nonEmpty()]},email:{checks:[l.nonEmpty(),l.max(100,s.tooBig()),l.min(6,s.tooSmall()),{test:a.regExp.bind(null,/^(\w+[-\.]??)+@[\w.-]+\w\.\w{2,5}$/i)}]},username:{checks:[l.nonEmpty(),l.max(30),l.min(5),{errorMessage:"must only contain alphanumeric symbols",test:a.regExp.bind(null,/^[A-Z0-9-]+$/i)}]},password:{checks:[l.nonEmpty(),l.max(30),l.min(5),{errorMessage:"[property] is too weak",test:a.regExp.bind(null,/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/)}]},"password-again":{checks:[l.nonEmpty("re-enter [property]"),{errorMessage:"passwords do not match",test:function(t,e,i){var r=e.password;if(!r)throw Error("no original password reference");for(var o=0;o<i.length;o++)if(i[o].property===r)return t===i[o].value;throw Error("no orginal password data")}}]},url:{checks:[{test:function(t){var e="^(?!mailto:)(?:(?:http|https)://)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$",i=RegExp(e,"i");return t.length<2083&&i.test(t)}}]},description:{checks:[l.max(255)]},comment:{checks:[l.nonEmpty(),l.max(255)]}};t.exports={getErrorArray:r,testProperty:o}},function(t,e,i){"use strict";var r=i(18),o=i(23).getErrorArray,n=i(15).ClientError,s=function(t){var e=this;this.elem=t.elem,this.fields=t.fields,this.url=t.url,this.isAvailable=!0,this.saveButton=this.elem.querySelector(".save-button"),this.elem.onclick=function(t){if(e.isAvailable&&t.target===e.saveButton){e.clearErrorBoxes();var i=e.getErrors();0===i.length?e.send(e.getBody()):e.setErrors(i)}}};s.prototype.setPropertyError=function(t,e){this.getErrorBox(t).textContent=e},s.prototype.getErrorBox=function(t){return this.elem[t].parentElement.querySelector(".textbox__error")},s.prototype.setAvailable=function(t){this.isAvailable=t},s.prototype.getDataObj=function(){var t=[];for(var e in this.fields){var i=this.fields[e];i.noValidation||(i.property||(i.property=e),i.value=this.elem[e].value,t.push(i))}return t},s.prototype.send=function(t){var e=this;i(25)(t,"POST",this.url,function(t,i){return t?void(t instanceof n&&t.detail?e.setPropertyError(t.detail.property,t.message):e.error(t)):(e.clear(),void e.trigger("form_sent",{response:i}))})},s.prototype.clearErrorBoxes=function(){for(var t in this.fields)this.getErrorBox(t).textContent=""},s.prototype.clear=function(){this.clearErrorBoxes();for(var t in this.fields)this.elem[t].value=""},s.prototype.getErrors=function(){return o(this.getDataObj())},s.prototype.setErrors=function(t){this.clearErrorBoxes();for(var e=0;e<t.length;e++)""==this.getErrorBox(t[e].property).textContent&&this.setPropertyError(t[e].property,t[e].message)},s.prototype.getBody=function(){var t="";for(var e in this.fields)this.fields[e].extra||(t+=(""===t?"":"&")+e+"="+encodeURIComponent(this.elem[e].value));return t};for(var a in r)s.prototype[a]=r[a];t.exports=s},function(t,e,i){"use strict";var r=i(15).ServerError,o=i(15).ClientError;t.exports=function(t,e,i,n){var s="";if("string"!=typeof t)for(var a in t){var l="";t[a]&&(l=a+"="+encodeURIComponent("object"==typeof t[a]?JSON.stringify(t[a]):t[a])),l&&(s+=(""===s?"":"&")+l)}else s=t;var c=new XMLHttpRequest;c.open(e,i,!0),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.onreadystatechange=function(){if(4==this.readyState){var t=void 0;if(!this.responseText)return void n(new r("Server is not responding"));t=JSON.parse(this.responseText),this.status>=200&&this.status<300&&n(null,t),this.status>=400&&this.status<500&&n(new o(t.message,t.detail,this.status)),this.status>=500&&n(new r(t.message,this.status))}},c.send(s)}}]);