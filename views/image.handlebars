{{#section 'scripts'}}
	<script defer src="/common-image.js"></script>
	<script defer src="/image.js"></script>
	{{#if loggedUser}}
		<script defer src="/logged-image.js"></script>
	{{/if}}
{{/section}}

<div class="image-post-wrapper">
    <div id="image-post" class="image-post-wrapper__image-post image-post">
        <div class="image-post__image-wrapper">
            <img class="image-post__image" src="/image{{image._id}}.jpg" alt="">
        </div>
        <div class="image-post__sidebar">
            <div class="image-post__top-side">
                <div class="header image-post__header">
                    <a class="image-post__header-left-side" href="{{author.url}}">
                        <div class="image-post__avatar"
                             style="background-image: url('{{author.avatarUrls.medium}}')"></div>
                        <div class="image-post__metadata">
                            <div class="image-post__username">{{author.username}}</div>
                            <div class="image-post__post-date">{{image.createDateStr}}</div>
                        </div>
                    </a>

                    {{#if ownImage}}
                        <div id="delete-image-button" class="button image-post__subscribe-button">
                            delete
                        </div>
                    {{else}}
                        <div id="subscribe-button"
                            {{#if isSubscribed}}
                             data-active="true"
                            {{/if}}
                             class="button image-post__subscribe-button">
                            subscribe
                        </div>
                    {{/if}}


                </div>
                <div class="image-post__info-board">
                    <div id="like"
                         data-like-amount="{{image.likes.length}}"
                         {{#if isLiked}}data-active="true"{{/if}}
                         class="button like-button image-post__like-button{{#if isLiked}} button_active{{/if}}">
                        like {{image.likes.length}}
                    </div>
                    <div class="image-post__description">
                        {{image.description}}
                    </div>

                </div>
                <div id="comment-section" class="comment-section image-post__comment-section">
                    {{#each image.comments}}
                        {{> comment
                                commentId=_id
                                username=commentator.username
                                date=createDateStr
                                text=text
                                ownComment=ownComment
                                avatarUrl=commentator.avatarUrls.medium
                                userUrl=commentator.url
                        }}
                    {{/each}}
                    {{> comment
                            commentId=0
                            username=loggedUser.username
                            avatarUrl=loggedUser.avatarUrls.medium
                            date='a few seconds ago'
                            ownComment=true
                            ghost=true
                    }}
                </div>
            </div>

            <div id="comment-send" class="panel comment comment-send image-post__comment-send"
                 data-image-id="{{image._id}}">
                <div class="comment__top-side">
                    <div class="comment__avatar"
                         style="background-image: url('{{loggedUser.avatarUrls.medium}}')"></div>
                    <div class="comment__username">{{loggedUser.username}}</div>
                </div>

                <textarea placeholder="share your opinionâ€¦" class="comment-send__textarea"></textarea>
                <div class="button comment-send__send-button">send</div>
            </div>
        </div>
    </div>
</div>
